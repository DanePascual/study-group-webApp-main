<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.0/font/bootstrap-icons.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../styles/reset-password.css" />
    <title>Reset Password - Study Group</title>
  </head>
  <body>
    <div class="main-container">
      <div class="reset-card" id="resetForm" style="display: none">
        <!-- Left side -->
        <div class="left-section">
          <div class="left-content">
            <div class="reset-icon">
              <i class="bi bi-shield-lock"></i>
            </div>
            <div class="welcome-title">Create New Password</div>
            <div class="welcome-subtitle">
              Enter a strong password to secure your StudyGroup account
            </div>

            <div class="login-section">
              <div class="login-text">Remember your password?</div>
              <button class="login-btn" onclick="goToLogin()">
                Back to Login
              </button>
            </div>
          </div>
        </div>

        <!-- Right side -->
        <div class="right-section">
          <div class="reset-header">
            <h1 class="reset-title">Reset Your Password</h1>
            <p class="reset-subtitle">Please enter your new password below</p>
          </div>

          <div class="email-display" id="emailDisplay">
            <i class="bi bi-envelope-check"></i>
            <span
              >Resetting password for:
              <strong id="resetEmail">Loading...</strong></span
            >
          </div>

          <form id="resetPasswordForm">
            <div class="form-group">
              <label class="form-label">New Password</label>
              <div style="position: relative">
                <input
                  type="password"
                  class="form-input"
                  id="newPassword"
                  placeholder="Enter your new password"
                  required
                />
                <i class="bi bi-lock input-icon"></i>
                <button
                  type="button"
                  class="password-toggle"
                  onclick="togglePassword('newPassword', 'newPasswordIcon')"
                >
                  <i class="bi bi-eye" id="newPasswordIcon"></i>
                </button>
              </div>
              <div class="password-strength">
                <div
                  class="password-strength-bar"
                  id="passwordStrengthBar"
                ></div>
              </div>
            </div>

            <div class="password-requirements">
              <div class="requirements-title">Password Requirements:</div>
              <div class="requirement-item" id="req-length">
                <i class="bi bi-circle"></i>
                <span>At least 8 characters</span>
              </div>
              <div class="requirement-item" id="req-uppercase">
                <i class="bi bi-circle"></i>
                <span>One uppercase letter</span>
              </div>
              <div class="requirement-item" id="req-lowercase">
                <i class="bi bi-circle"></i>
                <span>One lowercase letter</span>
              </div>
              <div class="requirement-item" id="req-number">
                <i class="bi bi-circle"></i>
                <span>One number</span>
              </div>
              <div class="requirement-item" id="req-special">
                <i class="bi bi-circle"></i>
                <span>One special character (!@#$%^&*)</span>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">Confirm New Password</label>
              <div style="position: relative">
                <input
                  type="password"
                  class="form-input"
                  id="confirmPassword"
                  placeholder="Confirm your new password"
                  required
                />
                <i class="bi bi-lock-fill input-icon"></i>
                <button
                  type="button"
                  class="password-toggle"
                  onclick="togglePassword('confirmPassword', 'confirmPasswordIcon')"
                >
                  <i class="bi bi-eye" id="confirmPasswordIcon"></i>
                </button>
              </div>
            </div>

            <button type="submit" class="reset-btn" id="resetBtn">
              <span class="loading-spinner" id="loadingSpinner"></span>
              <span id="btnText">Reset Password</span>
            </button>
          </form>
        </div>
      </div>

      <!-- Error State -->
      <div class="status-card" id="errorState" style="display: none">
        <div class="status-icon error">
          <i class="bi bi-exclamation-triangle"></i>
        </div>
        <h2 class="status-title">Invalid Reset Link</h2>
        <p class="status-message">
          This password reset link is invalid or has expired. Please request a
          new password reset link to continue.
        </p>
        <a href="login.html" class="status-btn">
          <i class="bi bi-arrow-left"></i>
          Back to Login
        </a>
      </div>

      <!-- Success State -->
      <div class="status-card" id="successState" style="display: none">
        <div class="status-icon success">
          <i class="bi bi-check-circle"></i>
        </div>
        <h2 class="status-title">Password Reset Successful!</h2>
        <p class="status-message">
          Your password has been successfully updated. You can now sign in with
          your new password.
        </p>
        <a href="login.html" class="status-btn">
          <i class="bi bi-box-arrow-in-right"></i>
          Sign In Now
        </a>
      </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="../scripts/reset-password.js"></script>
  </body>
</html>
